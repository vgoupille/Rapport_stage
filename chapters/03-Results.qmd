# Results

- 4 librairies de tialles pas equivalentes (voir Solène qui explique pourquoi avant pas equivalente exactement )
- impact l'efficacité des librairies 
- => conseille : equilibrer les librair


## Trimming


-   renvoie vers l'annexe pour les multiqc (fastp, cutadapt) avant et apres trimming
-   
- mais au final on obtient des resultats tres interessants et propres 





=> peut etre il aurait été interressant de faire un trimming comme kuchina 2021 pour comparer les resultats 
=> renvoie vers la discussion pour le trimming fait dans l'article de [@kuchina2021]
    - avait presque 90% de saturation => a verifier si c'est vraiment le cas 
    - et 10 % des sequences avec TSO  (voir Annexe)

-   Summary table of Starsolo results
-   numbers of reads before and after trimming
-   taux de saturation ...
-   => renvoie vers la discussion pour les taux de saturation

figure - ![](../figures/trimming_quality.png)

## STARsolo
-pour starsolo renvoie un gene qui serait mal annoté donc est automatiquement ignoré 

commande starsolo suivante comme dans bretn
permet UMI a une erreur...
possition des barcodes  

## Genome

## Transcriptome

-   figure de % de type of RNA
-   ![](../figures/pourcentage_RNA.png)


# Fitrage des cellules 

- reflexion sur le filtrages des cellules est complexe : comme mentionnée dans l'article de 
il existe des methodes de filtrages plus ou moins complexes  
-filtrage sur le types de reads,  globales ou seuils differents entre les differentes conditions biologiques 
-filtrage sur le nombre de reads par cellule 
-filtrage sur le nombre de genes exprimés par cellule 
-filtrage sur le nombre de reads par gene 
- filtrage avec un threashold 

- dans l'article de kuchina 2021 , ils ont utilisé un seuil de 200 UMI par cellule 
- 
- preprint de ... pourrait etre interessant de se focus aussi sur rRNA (lien avec growth rate)




# 

housekeeping genes 


choix ou non de pooler les replicas techniques ensembles 














## Summary of results


ici inclure un lien vers les html des multiqc avant et apres trimming pour les R1 

## Rapports de qualité MultiQC

Les rapports détaillés de qualité des séquences sont disponibles en ligne dans le dépôt GitHub du projet. 
Les analyses montrent une qualité de séquençage élevée avant et après le trimming, avec des métriques détaillées 
disponibles dans les rapports suivants :

::: {.callout-note}
## Rapports MultiQC disponibles en ligne

Les rapports complets de qualité sont accessibles aux adresses suivantes :
- [Rapport MultiQC après trimming](https://github.com/vgoupille/Rapport_stage/blob/main/docs/multiqc_reports/multiqc_report.html)
- [Rapport FastQC individuel avant trimming (BC_0076_R1)](https://github.com/vgoupille/Rapport_stage/blob/main/docs/multiqc_reports/BC_0076_R1_fastqc.html)

Ces rapports fournissent une analyse détaillée de la qualité des séquences avant et après le trimming, 
permettant d'évaluer l'efficacité de notre pipeline de prétraitement.
:::

Les métriques clés de qualité sont résumées dans les tableaux ci-dessous.



| Sample Name  | Dups   | GC     | Median len | Seqs    |
|--------------|--------|---------|------------|---------|
| BC_0076_R1  | 94.5%  | 55.0%  | 241bp      | 631.4M  |
| BC_0077_R1  | 94.1%  | 53.0%  | 241bp      | 325.5M  |
| BC_0079_R1  | 93.8%  | 53.0%  | 241bp      | 379.1M  |
| BC_0080_R1  | 94.6%  | 54.0%  | 241bp      | 397.7M  |
| **Total**   | -      | -      | -          | **1,733.7M** |
: Before trimming {#tbl-example layout-ncol="1"}




| Sample Name  | Dups   | GC    | Median len | Seqs   |
|--------------|--------|--------|------------|---------|
| BC_0076_R1  | 98.7%  | 51.0%  | 127bp      | 450.8M  |
| BC_0077_R1  | 98.6%  | 51.0%  | 157bp      | 248.4M  |
| BC_0079_R1  | 98.6%  | 51.0%  | 152bp      | 285.2M  |
| BC_0080_R1  | 98.7%  | 51.0%  | 132bp      | 300.1M  |
| **Total**   | -      | -      | -          | **1,284.5M** |
: After trimming {#tbl-example layout-ncol="1"}





| Sample Name  | Before Trimming |            | After Trimming |            | Change in |           |
|--------------|----------------|------------|----------------|------------|-----------|-----------|
|              | Median len     | Seqs       | Median len     | Seqs      | Length    | Sequences |
|--------------|----------------|------------|----------------|------------|-----------|-----------|
| BC_0076_R1  | 241bp          | 631.4M     | 127bp          | 450.8M    | -47.3%    | -28.6%    |
| BC_0077_R1  | 241bp          | 325.5M     | 157bp          | 248.4M    | -34.9%    | -23.7%    |
| BC_0079_R1  | 241bp          | 379.1M     | 152bp          | 285.2M    | -36.9%    | -24.8%    |
| BC_0080_R1  | 241bp          | 397.7M     | 132bp          | 300.1M    | -45.2%    | -24.5%    |
| **Mean**     | **241bp**      | **433.4M**  | **142bp**      | **321.1M** | -         | -         |
| **Total**    | -              | **1733.7M** | -              | **1284.5M**| **-41.1%**| **-25.4%**|
: Summary of sequence metrics before and after trimming, including percentage changes {#tbl-summary layout-ncol="1"}



| Metric                | Count      |
|----------------------|------------|
| nNoAdapter           | 0          |
| nNoUMI              | 0          |
| nNoCB               | 67,177     |
| nNinCB              | 0          |
| nNinUMI             | 16,893,550 |
| nUMIhomopolymer     | 1,697,129  |
| nTooMany            | 0          |
| nNoMatch            | 163,166,830|
| nMismatchesInMultCB | 3,323,192  |
| nExactMatch         | 1,046,121,284|
| nMismatchOneWL      | 53,206,471 |
| nMismatchToMultWL   | 0          |
: STARsolo barcode statistics {#tbl-starsolo layout-ncol="1"}

| Metric                | Count      |
|----------------------|------------|
| nUnmapped            | 114,628,761|
| nNoFeature           | 13,153,735 |
| nAmbigFeature        | 936,951,032|
| nAmbigFeatureMultimap| 935,077,136|
| nTooMany             | 0          |
| nNoExactMatch        | 125,216    |
| nExactMatch          | 4,471,174,098|
| nMatch               | 971,519,404|
| nMatchUnique         | 34,593,349 |
| nCellBarcodes        | 699,355    |
| nUMIs                | 34,258,961 |
: STARsolo feature mapping statistics {#tbl-starsolo-features layout-ncol="1"}

| Metric                                        | Value      |
|----------------------------------------------|------------|
| Number of Reads                              | 1,284,475,633 |
| Reads With Valid Barcodes                    | 85.58%     |
| Sequencing Saturation                        | 0.97%      |
| Q30 Bases in CB+UMI                         | 95.51%     |
| Q30 Bases in RNA read                       | 95.79%     |
| Reads Mapped to Genome: Unique+Multiple     | 89.57%     |
| Reads Mapped to Genome: Unique              | 3.64%      |
| Reads Mapped to GeneFull: Unique+Multiple   | 75.64%     |
| Reads Mapped to GeneFull: Unique            | 2.69%      |
| Estimated Number of Cells                    | 27,203     |
| Unique Reads in Cells Mapped to GeneFull    | 12,794,311 |
| Fraction of Unique Reads in Cells           | 36.98%     |
| Mean Reads per Cell                         | 470        |
| Median Reads per Cell                       | 381        |
| UMIs in Cells                               | 12,663,144 |
| Mean UMI per Cell                           | 465        |
| Median UMI per Cell                         | 378        |
| Mean GeneFull per Cell                      | 296        |
| Median GeneFull per Cell                    | 258        |
| Total GeneFull Detected                     | 6,035      |
: STARsolo summary statistics {#tbl-starsolo-summary layout-ncol="1"}




##### Final effective command line of STARsolo:
**STAR** \
    **--runThreadN** 64 \
    **--genomeDir** /path/to/genome_index \
    **--readFilesIn** \
        /path/to/input/merged_trimmed-R1.fastq.gz \
        /path/to/input/merged_trimmed-R2.fastq.gz \
    **--readFilesCommand** gunzip -c \
    **--outFileNamePrefix** /path/to/output/starsolo_output/ \
    **--outSAMtype** BAM Unsorted \
    **--outFilterScoreMinOverLread** 0 \
    **--outFilterMatchNmin** 50 \
    **--outFilterMatchNminOverLread** 0 \
    **--alignSJoverhangMin** 1000 \
    **--alignSJDBoverhangMin** 1000 \
    **--soloType** CB_UMI_Complex \
    **--soloCBwhitelist** \
        /path/to/barcodes/barcode_round3.txt \
        /path/to/barcodes/barcode_round2.txt \
        /path/to/barcodes/barcode_round1.txt \
    **--soloFeatures** Gene GeneFull \
    **--soloUMIdedup** 1MM_All \
    **--soloCBmatchWLtype** 1MM \
    **--soloCBposition** 0_10_0_17 0_48_0_55 0_78_0_85 \
    **--soloUMIposition** 0_0_0_9 \
    **--soloMultiMappers** Uniform

### STARsolo Parameters Explanation

This section details the key parameters used in our STARsolo analysis and their significance:

#### General STAR Parameters
- `--runThreadN 64` : Use of 64 threads for parallel alignment
- `--genomeDir` : Path to the reference genome index
- `--readFilesIn` : Input FASTQ files (R1 and R2)
- `--readFilesCommand gunzip -c` : Command to decompress FASTQ.gz files
- `--outFileNamePrefix` : Prefix for output files
- `--outSAMtype BAM Unsorted` : Unsorted BAM output format

#### Filtering Parameters
- `--outFilterScoreMinOverLread 0` : Minimum filtering score relative to read length
- `--outFilterMatchNmin 50` : Minimum number of matching bases for a valid alignment
- `--outFilterMatchNminOverLread 0` : Minimum match ratio relative to read length
- `--alignSJoverhangMin 1000` and `--alignSJDBoverhangMin 1000` : Strict parameters for splice junction detection

#### STARsolo-specific Parameters
- `--soloType CB_UMI_Complex` : Analysis type for cell barcodes (CB) and complex UMIs
- `--soloCBwhitelist` : List of valid cell barcodes for the three barcoding rounds
- `--soloFeatures Gene GeneFull` : Analysis of features at both gene and full transcript levels
- `--soloUMIdedup 1MM_All` : UMI deduplication with one mutation tolerance
- `--soloCBmatchWLtype 1MM` : Cell barcode matching with one mutation tolerance
- `--soloCBposition` : Cell barcode positions in reads (3 rounds)
  - Round 1: 0_10_0_17
  - Round 2: 0_48_0_55
  - Round 3: 0_78_0_85
- `--soloUMIposition 0_0_0_9` : UMI position in reads
- `--soloMultiMappers Uniform` : Uniform distribution of multi-mapped reads

These parameters were chosen to optimize single-cell detection while maintaining high alignment quality and accounting for the complexity of our three-round barcoding protocol.










## Overview

This chapter presents the findings of our single-cell RNA-seq analysis of Pseudomonas, focusing on the division of labor within bacterial populations.

## Single-cell RNA-seq Analysis

### Data Quality and Preprocessing

### Cell Type Identification

### Differential Expression Analysis

### Division of Labor Patterns

## Functional Analysis

### Pathway Enrichment

### Gene Set Analysis

### Regulatory Network Analysis

## Integration with Previous Studies

## Summary of Key Findings